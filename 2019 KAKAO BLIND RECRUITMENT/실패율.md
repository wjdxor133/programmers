# 문제 설명

![실패율 이미지](https://user-images.githubusercontent.com/47416686/119213329-47d9a100-baf9-11eb-84fb-c59eb66c84c6.png)

슈퍼 게임 개발자 오렐리는 큰 고민에 빠졌다. 그녀가 만든 프랜즈 오천성이 대성공을 거뒀지만, 요즘 신규 사용자의 수가 급감한 것이다. 원인은 신규 사용자와 기존 사용자 사이에 스테이지 차이가 너무 큰 것이 문제였다.

이 문제를 어떻게 할까 고민 한 그녀는 동적으로 게임 시간을 늘려서 난이도를 조절하기로 했다. 역시 슈퍼 개발자라 대부분의 로직은 쉽게 구현했지만, 실패율을 구하는 부분에서 위기에 빠지고 말았다. 오렐리를 위해 실패율을 구하는 코드를 완성하라.

- 실패율은 다음과 같이 정의한다.
- 스테이지에 도달했으나 아직 클리어하지 못한 플레이어의 수 / 스테이지에 도달한 플레이어 수

전체 스테이지의 개수 N, 게임을 이용하는 사용자가 현재 멈춰있는 스테이지의 번호가 담긴 배열 stages가 매개변수로 주어질 때, 실패율이 높은 스테이지부터 내림차순으로 스테이지의 번호가 담겨있는 배열을 return 하도록 solution 함수를 완성하라.

### 제한사항

- 스테이지의 개수 N은 `1` 이상 `500` 이하의 자연수이다.
- stages의 길이는 `1` 이상 `200,000` 이하이다.
- stages에는 `1` 이상 `N + 1` 이하의 자연수가 담겨있다.
  - 각 자연수는 사용자가 현재 도전 중인 스테이지의 번호를 나타낸다.
  - 단, `N + 1` 은 마지막 스테이지(N 번째 스테이지) 까지 클리어 한 사용자를 나타낸다.
- 만약 실패율이 같은 스테이지가 있다면 작은 번호의 스테이지가 먼저 오도록 하면 된다.
- 스테이지에 도달한 유저가 없는 경우 해당 스테이지의 실패율은 `0` 으로 정의한다.

## 입출력 예

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8cbc6424-912a-4f0e-961b-efb9196f271a/__.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8cbc6424-912a-4f0e-961b-efb9196f271a/__.png)

### 입출력 예 설명

**입출력 예 #1**

1번 스테이지에는 총 8명의 사용자가 도전했으며, 이 중 1명의 사용자가 아직 클리어하지 못했다. 따라서 1번 스테이지의 실패율은 다음과 같다.

- 1 번 스테이지 실패율 : 1/8

2번 스테이지에는 총 7명의 사용자가 도전했으며, 이 중 3명의 사용자가 아직 클리어하지 못했다. 따라서 2번 스테이지의 실패율은 다음과 같다.

- 2 번 스테이지 실패율 : 3/7

마찬가지로 나머지 스테이지의 실패율은 다음과 같다.

- 3 번 스테이지 실패율 : 2/4
- 4번 스테이지 실패율 : 1/2
- 5번 스테이지 실패율 : 0/1

각 스테이지의 번호를 실패율의 내림차순으로 정렬하면 다음과 같다.

- [3,4,2,1,5]

**입출력 예 #2**

모든 사용자가 마지막 스테이지에 있으므로 4번 스테이지의 실패율은 1이며 나머지 스테이지의 실패율은 0이다.

- [4,1,2,3]

## 내가 짠 코드

```jsx
function solution(N, stages) {
  const stagesObj = {};
  let stagesLen = stages.length;
  let answer = [];
  if (!stages.filter((stage) => stage !== N).length) {
    for (let i = 1; i <= N - 1; i++) {
      answer.push(i);
    }
    answer.unshift(N);
  } else {
    for (let i = 1; i <= N; i++) {
      const filteredStages = stages.filter((stage) => stage === i);
      stagesObj[i] = filteredStages.length / stagesLen;
      stagesLen = stagesLen - filteredStages.length;
    }
    answer = Object.entries(stagesObj)
      .sort((a, b) => b[1] - a[1])
      .map((el) => Number(el[0]));
  }
  return answer;
}
```

- 스테이지의 `실패율`을 구하는 문제이다.
- `실패율` **=** `스테이지에 도달했으나 아직 클리어하지 못한 플레이어의 수` **/** `스테이지에 도달한 플레이어 수`
- stages 배열에는 **어느 단계의 스테이지에 머물고 있는지의 플레이어들**이 담겨져있다.
- 전체 스테이지 수 N 단계를 가지고 `for문`을 통해 스테이지 1부터 N까지 반복문을 돌린다.
- 1부터 순서대로 도장깨기 방식이라고 보면 된다.

1부터 N까지 단계별 머물고 있는 플레이어들의 수 [2, 1, 2, 6, 2, 4, 3, 3] 총 8명이 있다.

**i = 1** 일때, 스테이지의 1단계를 의미하고 배열 안에는 1단계에서 머무는 플레이어 1명이 있다.
`스테이지에 도달한 플레이어 수` **=** 전체 플레이어 수 8명 **-** 현재 스테이지에 도달했으나 클리어하지 못한 플레이어 수 1명
`스테이지에 도달한 플레이어 수`를 구하고 다음 단계에 가기 전에 클리어하지 못한 플레이어 수를 빼고 이동한다.

**i = 2** 일때, 스테이지의 2단계를 의미하고 배열 안에는 2단계에서 머무는 플레이어 3명이 있다.
`스테이지에 도달한 플레이어 수` **=** 전체 플레이어 수 7명 **-** 현재 스테이지에 도달했으나 클리어하지 못한 플레이어 수 3명

이런식으로 진행한다.

- 스테이지 1부터 N까지 loop을 돌때 `filter()`를 사용해서 `스테이지에 도달했으나 아직 클리어하지 못한 플레이어의 수`를 반환한다.
- 이제 여기서 제일 중요한 실패율을 구해야 하기 때문에 `스테이지에 도달한 플레이어 수`를 구해야 한다.
- `스테이지에 도달한 플레이어 수`는 `전체 플레이어의 수`에서 `스테이지에 도달했으나 아직 클리어하지 못한 플레이어의 수`를 뺀 나머지 값을 의미한다.
- `스테이지에 도달했으나 아직 클리어하지 못한 플레이어의 수`와 `스테이지에 도달한 플레이어 수`를 구했기 때문에 실패율을 구할 수 있다.
- 하지만 여기서 각 단계별로 실패율을 저장해야 한다.
- 그래서 나는 여기서 객체를 사용하기로 했다.
- 모든 loop이 다 돌고나면 각 단계별로 실패율이 저장되어 있을 것이다.
- 그러면 이제 실패율 값 기준으로 내림차순 정렬을 해야한다.
- `Object.entries()` 를 사용해서 `[키, 값] 형식`으로 변환하고 `sort()`를 통해서 내림차순으로 정렬해준다.
- 내림차순으로 정렬이 되고 나면 이제 `map()`을 사용해서 해당 원소의 첫번째 index를 반환한다.
- 단 모든 사용자가 마지막 스테이지에 있을 때, 1부터 N단계 이전까지 배열을 만든다.
- 모든 사용자가 마지막 스테이지에 있으면 N번 스테이지의 실패율은 1이고 나머지는 0을 의미한다.
- 따라서 실패율이 가장 높은 마지막 단계 N값을 `unshift()`를 사용해서 맨 앞에 추가해서 반환한다.

## ✔️ 참고

[코딩테스트 연습 - 실패율](https://programmers.co.kr/learn/courses/30/lessons/42889)

[[자바스크립트] 배열의 맨 앞에 추가하거나 삭제하기, shift, unshift](https://webisfree.com/2021-01-06/[%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8]-%EB%B0%B0%EC%97%B4%EC%9D%98-%EB%A7%A8-%EC%95%9E%EC%97%90-%EC%B6%94%EA%B0%80%ED%95%98%EA%B1%B0%EB%82%98-%EC%82%AD%EC%A0%9C%ED%95%98%EA%B8%B0-shift-unshift)

[Object.entries() - JavaScript | MDN](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)

[Sort objects in JavaScript e.c. how to get sorted values from an object.](https://medium.com/@gmcharmy/sort-objects-in-javascript-e-c-how-to-get-sorted-values-from-an-object-142a9ae7157c)
